{% extends "base.html" %}
{% load static %}

{% block main_content %}

<link rel="stylesheet" href="{% static 'css/timetablejs.css' %}">
<script src="{% static 'js/timetable.js' %}" type="text/javascript"></script>

<div>
{% for date in dates %}
    <button data-day="day-{{ date|date:"j" }}">{{ date|date:"j/n/Y" }}</button>
{% endfor %}
</div>

<div class="timetable"></div>
<script>

    var timetable = new Timetable();
    var rooms = [];
    {%  for room in rooms %}
        rooms.push('{{ room.name }}');
    {% endfor %}
    timetable.addLocations(rooms);

    {% for date, slots in slots_by_date.items %}
        {% for slot in slots %}

            timetable.addEvent(
                '{{ slot.talk.title }}',
                '{{ slot.room.name }}',
                new Date({{ slot.from_date|date:"Y,n-1,j,H,i"}}),
                new Date({{ slot.to_date|date:"Y,n-1,j,H,i"}}),
                {
                  url: '#', // makes the event clickable
                  class: 'day-{{ slot.from_date|date:"j" }}', // additional css class
                  data: { // each property will be added to the data-* attributes of the DOM node for this event
                    day: '{{ slot.from_date|date:"Y,n-1,j" }}',
                    description: '{{ slot.talk.description | linebreaksbr }}',
                  },
                  onClick: function(event, timetable, clickEvent) {},
                }
            );

        {% endfor %}

        var renderer = new Timetable.Renderer(timetable);
        renderer.draw('.timetable');

    {% endfor %}
</script>

{% endblock main_content %}

{% block scripts %}
    <script>
    $(window).ready(function() {
        $(".time-entry").hide();
        $(".day-3").show();
        $("button").click(function(e){
            console.log(timetable);
            $(".time-entry").hide();
            var cl = $(this).data('day');
            console.log(cl);
            $('.'+cl).show();
        });
    });
    </script>
{% endblock %}